services:
  logger.channel.culturefeed:
    parent: logger.channel_base
    arguments: ['culturefeed']
  culturefeed.oauth_client:
    class: Drupal\culturefeed\OAuthClientFactory
    arguments: ['@config.factory']
  culturefeed.user_name.factory:
    class: Drupal\culturefeed\UserNameFactory
    arguments: ['@entity.query', '@current_user']
  culturefeed.user_map:
    class: Drupal\culturefeed\UserMap
    arguments: ['@entity.manager', '@entity.query', '@current_user', '@culturefeed.user_name.factory']
  culturefeed.user_credentials.factory:
    class: Drupal\culturefeed\UserCredentialsFactory
    arguments: ['@config.factory', '@current_user', '@culturefeed.user_map', '@entity.manager', '@entity.query', '@logger.channel.culturefeed']
  culturefeed.user_credentials:
    class: Drupal\culturefeed\UserCredentials
    factory_service: culturefeed.user_credentials.factory
    factory_method: get
  culturefeed.factory:
    class: Drupal\culturefeed\CultureFeedFactory
    arguments: ['@culturefeed.oauth_client', '@culturefeed.user_credentials', '@logger.channel.culturefeed']
  culturefeed.factory.authenticated:
    class: Drupal\culturefeed\CultureFeedFactory
    factory_service: culturefeed.factory
    factory_method: createAuthenticated
  culturefeed.authentication:
    class: Drupal\culturefeed\Authentication
    arguments: ['@culturefeed.factory', '@url_generator', '@culturefeed.user_map', '@entity.manager', '@entity.query']
  culturefeed.user_factory:
    class: Drupal\culturefeed\UserFactory
    arguments: ['@culturefeed.factory.authenticated', '@current_user', '@culturefeed.user_map']
  culturefeed.current_user:
    class: Drupal\culturefeed\UserFactory
    factory_service: culturefeed.user_factory
    factory_method: get
  culturefeed.consumer_credentials.factory:
    class: Drupal\culturefeed\ConsumerCredentialsFactory
    arguments: ['@config.factory', '@logger.channel.culturefeed']
  culturefeed.consumer_credentials:
    class: CultuurNet\Auth\ConsumerCredentials
    factory_service: culturefeed.consumer_credentials.factory
    factory_method: get

  access_check.culturefeed.current_user:
    class: Drupal\culturefeed\Access\UserAccess
    arguments: ['@culturefeed.current_user']
    tags:
      - { name: access_check, applies_to: _culturefeed_current_user }
